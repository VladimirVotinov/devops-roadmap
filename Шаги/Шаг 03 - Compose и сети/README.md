## ü™ú –®–∞–≥ 03 ‚Äî Docker Compose –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Å–µ—Ç—å

## üìñ –ß—Ç–æ –∏–∑—É—á–∏–ª (–ø—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏):

### üß© 1. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç `docker-compose` –∏ –µ–≥–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (services, volumes, networks)

`docker-compose` ‚Äî —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç **–∑–∞–ø—É—Å–∫–∞—Ç—å —Å—Ä–∞–∑—É –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤** –∏–∑ –æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ (`docker-compose.yml`).

–í —ç—Ç–æ–º —Ñ–∞–π–ª–µ —Ç—ã –æ–ø–∏—Å—ã–≤–∞–µ—à—å:

* `services`: –∫–∞–∫–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–ø—É—Å–∫–∞—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, `nginx`, `postgres`, `backend`, `frontend`)
* `volumes`: –∫–∞–∫–∏–µ –ø–∞–ø–∫–∏ –∏–ª–∏ —Ñ–∞–π–ª—ã –Ω—É–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –≤–Ω—É—Ç—Ä—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
* `networks`: –∫–∞–∫ —Å–æ–µ–¥–∏–Ω–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî –æ–¥–Ω–∞ –æ–±—â–∞—è —Å–µ—Ç—å)

üëâ –í–º–µ—Å—Ç–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∫–æ–º–∞–Ω–¥ —Ç—ã –∑–∞–ø—É—Å–∫–∞–µ—à—å –≤—Å—ë **–æ–¥–Ω–æ–π**:

```bash
docker-compose up -d
```

### üß± 2. –ß—Ç–æ —Ç–∞–∫–æ–µ –º–Ω–æ–≥–æ–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –∑–∞—á–µ–º –æ–Ω–∞ –Ω—É–∂–Ω–∞

–ú–Ω–æ–≥–æ–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ —Ç–≤–æ–π –ø—Ä–æ–µ–∫—Ç —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ **–Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤**, –∏ –∫–∞–∂–¥—ã–π –∏–∑ –Ω–∏—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Å–≤–æ—ë–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ.

–ü—Ä–∏–º–µ—Ä:

* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä 1: `nginx` (–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã)
* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä 2: `whoami` (–æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é)
* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä 3: `postgres` (–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)

–ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ:

* –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏: –∫–∞–∂–¥—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–µ–ª–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ—ë –¥–µ–ª–æ
* –£–¥–æ–±–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å: –º–æ–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—É—é —á–∞—Å—Ç—å
* –ì–∏–±–∫–æ—Å—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å: –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏

### üåê 3. –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `default` –∏ `custom` —Å–µ—Ç—è–º–∏ –≤ Docker

Docker —Å–∞–º —Å–æ–∑–¥–∞—ë—Ç **—Å–µ—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**, –µ—Å–ª–∏ —Ç—ã –Ω–µ —É–∫–∞–∑–∞–ª —Å–≤–æ—é. –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤ —ç—Ç–æ–π —Å–µ—Ç–∏ **–≤–∏–¥—è—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞ –ø–æ –∏–º–µ–Ω–∏ —Å–µ—Ä–≤–∏—Å–∞** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `nginx` –º–æ–∂–µ—Ç –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ `whoami` –ø—Ä–æ—Å—Ç–æ –ø–æ –∏–º–µ–Ω–∏ `whoami`).

–ù–æ —á–∞—Å—Ç–æ –ª—É—á—à–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å **—Å–≤–æ—é (custom)** —Å–µ—Ç—å ‚Äî —Ç–∞–∫ —Ç—ã:

* –î–∞—ë—à—å –µ–π –ø–æ–Ω—è—Ç–Ω–æ–µ –∏–º—è
* –õ—É—á—à–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—à—å, –∫—Ç–æ —Å –∫–µ–º –º–æ–∂–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å
* –ò–∑–±–µ–≥–∞–µ—à—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –ø—Ä–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–∏

–ü—Ä–∏–º–µ—Ä:

```yaml
networks:
  my_network:
```

### üîÅ 4. –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å NGINX –∫–∞–∫ reverse proxy –∫ –¥—Ä—É–≥–æ–º—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É (`whoami`)

**NGINX** ‚Äî —ç—Ç–æ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä, –Ω–æ –µ–≥–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ **–æ–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ–∫—Å–∏ (reverse proxy)**.

–≠—Ç–æ –∑–Ω–∞—á–∏—Ç:

* –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏—Ö–æ–¥–∏—Ç –ø–æ –∞–¥—Ä–µ—Å—É `localhost`
* NGINX –ø–æ–ª—É—á–∞–µ—Ç —ç—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å
* NGINX –ø–µ—Ä–µ—Å—ã–ª–∞–µ—Ç –µ–≥–æ –≤–æ **–≤—Ç–æ—Ä–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä** ‚Äî `whoami`
* –û—Ç–≤–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ NGINX –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

–í—Å—ë —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç **–≤–Ω—É—Ç—Ä–∏ Docker-—Å–µ—Ç–∏**, –∏ `nginx.conf` –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —ç—Ç–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ.

### üîç 5. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ —á–µ—Ä–µ–∑ –∏–º—è —Å–µ—Ä–≤–∏—Å–∞ (DNS –≤–Ω—É—Ç—Ä–∏ Docker-—Å–µ—Ç–∏)

–ö–æ–≥–¥–∞ —Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å `docker-compose`, –∫–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä) **–¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ —Å–≤–æ–µ–º—É –∏–º–µ–Ω–∏** ‚Äî —Ç–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π DNS –≤ Docker.

–ü—Ä–∏–º–µ—Ä:

```nginx
proxy_pass http://whoami:80;
```

–≠—Ç–æ –∑–Ω–∞—á–∏—Ç: **–ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤—å —Ç—Ä–∞—Ñ–∏–∫ –Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –∏–º–µ–Ω–µ–º `whoami`**, –∫–æ—Ç–æ—Ä—ã–π —Å–ª—É—à–∞–µ—Ç –ø–æ—Ä—Ç 80.

–ù–µ –Ω—É–∂–Ω–æ –ø—Ä–æ–ø–∏—Å—ã–≤–∞—Ç—å IP-–∞–¥—Ä–µ—Å ‚Äî Docker —Å–∞–º –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ç–∏ –≤—Å—ë –Ω–∞—Å—Ç—Ä–æ–∏—Ç.

## üõ† –ß—Ç–æ —Å–¥–µ–ª–∞–ª:

* –°–æ–∑–¥–∞–ª `docker-compose.yml` —Å –¥–≤—É–º—è —Å–µ—Ä–≤–∏—Å–∞–º–∏:
  * `nginx`
  * `whoami` (—Å–µ—Ä–≤–∏—Å, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∏–π IP –∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞)
* –ù–∞—Å—Ç—Ä–æ–∏–ª `nginx.conf`, —á—Ç–æ–±—ã –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–∞—Ñ–∏–∫ —Å `/` –Ω–∞ —Å–µ—Ä–≤–∏—Å `whoami`
* –ü–æ–¥–Ω—è–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π:

```bash
docker-compose up -d
```

–ü—Ä–æ–≤–µ—Ä–∏–ª –≤ –±—Ä–∞—É–∑–µ—Ä–µ –∏ —É–±–µ–¥–∏–ª—Å—è, —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ NGINX

## üßæ –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:

```bash
docker-compose up -d             # –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose ps                # –°–ø–∏—Å–æ–∫ —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker-compose logs nginx        # –õ–æ–≥–∏ nginx
docker network ls                # –°–ø–∏—Å–æ–∫ —Å–µ—Ç–µ–π Docker
docker network inspect <–∏–º—è_—Å–µ—Ç–∏>  # –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å–µ—Ç–∏
docker exec -it <–∏–º—è_–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞> sh  # –ó–∞–π—Ç–∏ –≤–Ω—É—Ç—Ä—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
```

## üì∏ –°–∫—Ä–∏–Ω—à–æ—Ç—ã:

‚úÖ –°–∫—Ä–∏–Ω –±—Ä–∞—É–∑–µ—Ä–∞, –≥–¥–µ –≤–∏–¥–Ω–æ –æ—Ç–≤–µ—Ç –æ—Ç `whoami` —á–µ—Ä–µ–∑ `nginx`

![1753637970502](images/README/1753637970502.png)

‚úÖ –°–∫—Ä–∏–Ω –∫–æ–º–∞–Ω–¥—ã `docker ps` ‚Äî 2 –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Ä–∞–±–æ—Ç–∞—é—Ç

![1753638032256](images/README/1753638032256.png)

‚úÖ –°–∫—Ä–∏–Ω `docker network ls` —Å —Å–æ–∑–¥–∞–Ω–Ω–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π —Å–µ—Ç—å—é

![1753638088389](images/README/1753638088389.png)

‚úÖ –°–∫—Ä–∏–Ω —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ `nginx.conf`

![1753638250879](images/README/1753638250879.png)
